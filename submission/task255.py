import re;p=lambda g,k=15:-k*g or[*zip(*eval(re.sub(*["\((%s|(0, )+3.{5}3),?"%re.search(r"([ ,03]{61,})(.*\1){3}|$",g:=str(p(g,k-1)))[1],"(?=0((,[^,]*){31}|, )[1-9])",r"(*[3]*len([\1]),","1<"][k<4::2],g)))][::-1]