p=lambda a,k=6,q=0:~k*a or p([[[2*q,v][q:=sum(a,r).count(v)<9-k]for v in r]for*r,in zip(*a)][::-1],k-2)