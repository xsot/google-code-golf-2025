def p(e):
 *u,l,n,i=sorted({*sum(e,[])},key=sum(e,[]).count)
 *u,=e,
 for f in u*6:
  for f in u+(u:=[]):
   u+=[],
   for f in zip(*f):u+=u.pop()+[f]if{n,i}-{*f}>{n}or{*f}>{n}else[],
 [6for m,u in sorted((-sum(l^u for u in u for u in u),u)for u in u)for m,f in enumerate(e)for s,f in enumerate(f)for o,f in zip(e[m:]+e,u*all((r==f)!=(l==f)==(r==i)for o,f in zip(e[m:]+e,u)for r,f in zip(o[s:s+len(f)]+e,f)))for o[s:s+len(f)]in[f]];return[f for f in zip(*[f for f in zip(*e)if i in f])if i in f]