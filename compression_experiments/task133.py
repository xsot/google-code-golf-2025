def p(u):
 *i,e={f*66+m:(u)for f,u in enumerate(u)for m,u in enumerate(u)if u},
 for f in e:
  r={f}
  for n in*i,:
   if{f-66,f-1}&n:i.remove(n);r|=n
  i+=r,
 for n in*i,:
  for f in n:
   for r in n:
    d=n
    for d in 1//len([l for l in d if e[f]==e[l]])*i:
     for o in n-{r}:
      for l in([l for l in d if e[f]==e[l]==e[r]]):l+=(len([l for l in d if e[f]==e[l]==e[r]])^6)%6*(o-r);u[l//66][l%66],={e[l]for l in d}-{e[f]}
 return u