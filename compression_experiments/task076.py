def	p(f):
	r={min(n:={o*1j+t:u	for	o,u	in	enumerate(f)for	t,u	in	enumerate(u)if	u},key=n.get)};e=n;[abs(t-o)<2!=r.add(o)for	o	in[*e]*6for	t	in[*r]]
	for	o,u	in	enumerate(f):
		for	t	in	e:a=min(n:={(t-o//4*t.real*2)*1j**o:e[t]^2for	t	in[*r]},key=n.get)-t;f=min(e.get(t-a,3)==13%-~n[t]^2for	t	in[*n])*[[n.get(o*1j+t+a,u^2)^2for	t,u	in	enumerate(u)]for	o,u	in	enumerate(f)]or	f
	return	f