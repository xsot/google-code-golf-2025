def p(a):e={r*1j+o:a for r,a in enumerate(a)for o,a in enumerate(a)if a};[(m:={i},[m:={i}|m for i in[*e]*5for j in m if abs(i-j)<2],[*m][3:]and[5for n in[1,3,6,7]for f in e if all(sum(e[j]==e.get(o)for o in[*m,(j-i-n//4*(j-i).real*2)*1j**n+f])>1for j in m)for j in m if(a:=[[{j:0,(j-i-n//4*(j-i).real*2)*1j**n+f:e[j]}.get(r*1j+o,a)for o,a in enumerate(a)]for r,a in enumerate(a)])])for i in e];return a