def p(f):e={i*1j+o:f for i,f in enumerate(f)for o,f in enumerate(f)if f};[(u:={r},[abs(l-a)<2==u.add(l)for l in[*e]*5for a in[*u]],[*u][3:]and[5for d in[1,3,6,7]for n in e if all(sum(e[l]==e.get(o)for o in[*u,(l-r-d//4*(l-r).real*2)*1j**d+n])>1for l in u)for l in u if(f:=[[{l:0,(l-r-d//4*(l-r).real*2)*1j**d+n:e[l]}.get(i*1j+o,f)for o,f in enumerate(f)]for i,f in enumerate(f)])])for r in e];return f