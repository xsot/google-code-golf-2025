def p(i):n={m*1j+a:i for m,i in enumerate(i)for a,i in enumerate(i)if i};[(u:={a},[abs(e-t)<2==u.add(e)for e in[*n]*5for t in[*u]],[*u][3:]and[5for f in[1,3,6,7]for r in n if all(sum(n[e]==n.get(a)for a in[*u,(e-a-f//4*(e-a).real*2)*1j**f+r])>1for e in u)for e in u for m,i[int(m.imag)][int(m.real)]in(((e-a-f//4*(e-a).real*2)*1j**f+r,n[e]),(e,0))])for a in n];return i