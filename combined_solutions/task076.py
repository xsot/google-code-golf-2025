def p(g,e=enumerate):
 G=g
 for _ in' '*96:G=[[*r][::-1]for r in zip(*G[[0]*len(G[0])in G[:min(y for y,r in e(G)if 3in r)]or{*sum(G[:5],[])}<={0,2,4}:])]
 for o in[0,1,1]*8:
  G=([[*r]for r in zip(*G[::-1])],G[::-1])[o];w=len(G[0])
  for y,r in e(g[:1-len(G)]):
   for x,c in e(r[:1-w]):
    for Y,R in e(G*all(C==g[Y+y][X+x]or C%2for Y,R in e(G)for X,C in e(R))):g[Y+y][x:x+w]=R
 return g