p=lambda g,k=59,e=enumerate:-k*g or p([*zip(*[[max(c,x+y<1,(v:=(*g[y-(y>0)][x-1:x+1],r[x-1]))==(5,0,0),y>1<x<sum(v)>10>4<g[y-1][x-2]+g[y-2][x-1]or[0,*r][x]%5)if k else c-c%5+0**c*4for x,c in e(r)]for y,r in e(g)][::-1])],k-1)