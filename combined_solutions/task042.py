p=lambda i,k=3,r=range(10):-k*i or p([*zip(*[[i[a][b]or i[max(0,a-(h:=sum(i,i[0]).count(3)+8>>3)*2)][max(b-h,0)]*i[max(a-h,0)][max(b-h*2,0)]%8*8for b in r]for a in r][::-1])],k-1)