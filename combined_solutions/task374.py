p=lambda i,k=39,t=0:-k*i or p([[0**k*sorted({*sum(i,[])}).index(y)*2%5or(y>0)*max(y,5+(t:=s and-~t),s)for y,s in zip(x,[0,*x])]for x in zip(*i[::-1])],k-1)