# combined (147 vs 103 bytes for gold)
p=lambda i,k=3,r=range(15):-k*i or p([[*[*zip(*i[::-1])][(1<abs((s:=[n-l for n in r if 2in[*zip(*i)][n]])[0])<4==len(s))*2*s[0]+l]]for l in r],k-1)
