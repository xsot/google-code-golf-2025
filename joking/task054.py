# zip fiddling
def p(g):
 *M,B,B=sorted({*sum(g,[])},key=sum(g,[]).count);M={i*1j+I:g for i,g in enumerate(g)for I,g in enumerate(g)if g in M};T={i for i in M for I in M if abs(i-I)==1}
 for i in{*M}-T:
  for I in T:
   d=I-sum(T)/len(T);P=I;g[int(I.imag)][int(I.real)],F,I=B,2,d+i
   while g[int(I.imag)][int(I.real)]*F^B*F:g[int(I.imag)][int(I.real)],F,I=M[P],abs(d)>=2,d/2+I
 return g

##
def p(g):
 *M,#[*'_BiIFdT']##,B=sorted({*sum(g,[])},key=sum(g,[]).count);M={i*1j+I:g for i,g in enumerate(g)for I,g in enumerate(g)if g in M};T={i for i in M for I in M if abs(#['i-I','I-i']##)==1}
 for i in{*M}-T:
  for I in T:
   d=I-sum(T)/len(T);P=I;g[int(I.imag)][int(I.real)],F,I=B,2,d+i
   while g[int(I.imag)][int(I.real)]*F^B*F:g[int(I.imag)][int(I.real)],F,I=M[P],abs(d)>=2,d/2+I
 return g