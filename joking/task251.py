p=lambda a,n=43:-n*a or[[14>>d&b.pop()or n<1for d in[0]+b[:0:-1]]for*b,in zip(*p(a,n-1))]

##
p=lambda a,n=-42:[*map(lambda*b,d=0:[max(n,14>>d&(d:=c))for c in b][::-1],*n*a or p(a,n+1))]
p=lambda a,n=43:-n*a or[[14>>d&b.pop()or 0**n for d in[0]+b[:0:-1]]for*b,in zip(*p(a,n-1))]
p=lambda a,n=43:-n*a or[*map(lambda*b,s=0:[d+0**n&s+9>>(s:=d)for d in b[::-1]],*p(a,n-1))]