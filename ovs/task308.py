e=enumerate
def p(g):q=range(min(A:={J+51-sum(C)//4:N for N in sum(g,g)if len(C:=[C+A*16for(A,B)in e(g)for(C,E)in e(B)if E==N])<5for J in C})>>4,max(A)//16+1);return[[A.get(y*16+x,*{*g[0]}&{*g[5]})for x in q]for y in q]
