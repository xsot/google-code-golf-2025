p=lambda i,n=16,e=1:[[(e:=e&len(r:={*t}&{*max(i,key=any)}))*sum(r)for t in zip(x,(x*2)[n::-1])]for x in i]*e or p(i,n+1)
