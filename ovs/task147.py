*r,p=[0]*9,lambda i,*w:i*0!=0and[*map(p,i,r+i,i[1:]+r,*w)]or(3in w)+7&i*9

##
p=lambda g,k=-3:g*k or p([[a+-a%~b%8for a,b in zip(r,[0]+r)]for*r,in zip(*g[::-1])],k+1)
