p=lambda i,k=39,s=[0]*99:-k*i or p([s:=[y and[y%7*9%13%9,(u*t>0)<<k%4*3+6|y|u][k>0]for y,t,u in zip(x,[0]+x,s)]for*x,in zip(*i)][::-1],k-1)
