p=lambda i,k=15:-k*i or p([[v%2*v|w%3for v,w in zip(r,[0]*(2in{*max(i,key=any)}&{*r})+r)]for*r,in zip(*i)][::-1],k-1)

## fails a single case:

p=lambda i,k=15:-k*i or p([([0]*(2in{*max(i,key=any)}&{*r})+r)[:len(r)]for*r,in zip(*i)][::-1],k-1)
