z=[0]
p=lambda g,k=-19,h=2,q=z*9:k*g or p([q:=[v and[v//sum(g,z).count(v),h:=h*64,*[P|p|v]*17,v%63][k]for P,p,v in zip(z+q,z+r,r)]for*r,in zip(*g[::-1])],k+1)
