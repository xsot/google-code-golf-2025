p=lambda i,k=3:-k*i or[[y or-(s*2^s-7)%7for y,s in zip(x,[0]+x)]for*x,in zip(*p(i,k-1)[::-1])]

##

E=enumerate
p=lambda g:[[v or max(v*95%9for r in g[i+i%~i:i+2]for v in[0,*r][j:j+3])for j,v in E(l)]for i,l in E(g)]
