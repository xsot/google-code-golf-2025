p=eval(('lambda i:'+'[[sum({r.pop()}&)r,r[1:])]*'*2+'[[r[0]r,*i)if]i if])])]').translate([0,"{*r}-{*i[0]}","zip(","for*r,in "]))

##
# 147
exec(f"def p(i):I=i;A=0;{'i=[[A*(A==(A:=B)!=c[0])for*c,B in zip(*I,a)if all(c)]for*a,in zip(*i)];'*2+'*i,=zip(*i[any(i[-1])-2::-1]);'*40}return i")

exec('def p(i):h={*i[0]};return'+'[[a*({a}=={b}-h)for a,b in zip(r,r[1:])]for*r,in zip(*'*2+'[[t[0]for t in zip(s,*i)if{*t}-h]for s in i if{*s}-h])])]')
