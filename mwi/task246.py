p=lambda a,n=3,d=0:-n*a or p([[b.pop()or(n|2in b)*d*4for c in a[::-1]if[d:=d^sum(c)&2]]for*b,in zip(*a)],n-1)